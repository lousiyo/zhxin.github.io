<!doctype html><html lang=zh dir=auto><head><meta charset=utf-8><meta http-equiv=x-ua-compatible content="IE=edge"><meta name=viewport content="width=device-width,initial-scale=1,shrink-to-fit=no"><meta name=robots content="index, follow"><title>Git 基本操作 | zhxin.xyz</title><meta name=keywords content="git"><meta name=description content="配置 git config --list --show-origin 查看所有配置信息 git config 命令带入&ndash;system参数会将配置写入/etc/gitconfig文件，对整个系统生效；&ndash;global选项会写入~/.gitconfig文件对当前用户所有仓库生效 #安装完成GIT之后配置相关用户名邮箱 git config --global user.name &#34;me&#34; git config --global user.email me@outlook.com git config --global core.editor vim git config --global log.date iso git config --global merge.conflictstyle diff3 git config --global merge.tool nvimdiff3 配置github ssh 访问 ls -al ~/.ssh [[查看是否生成SSH]] key ssh-keygen -t rsa -b 4096 -C &#34;me@outlook.com&#34; [[生成key"><meta name=author content><link rel=canonical href=https://zhxin.xyz/post/2021/03/git-%E5%9F%BA%E6%9C%AC%E6%93%8D%E4%BD%9C/><link crossorigin=anonymous href=/assets/css/stylesheet.02ea2e7282a9aa758fc343caf67c72663e6098185248e82139c0abccbe5b98ca.css integrity="sha256-AuoucoKpqnWPw0PK9nxyZj5gmBhSSOghOcCrzL5bmMo=" rel="preload stylesheet" as=style><script defer crossorigin=anonymous src=/assets/js/highlight.f413e19d0714851f6474e7ee9632408e58ac146fbdbe62747134bea2fa3415e0.js integrity="sha256-9BPhnQcUhR9kdOfuljJAjlisFG+9vmJ0cTS+ovo0FeA=" onload=hljs.initHighlightingOnLoad()></script>
<link rel=icon href=https://zhxin.xyz/favicon.ico><link rel=icon type=image/png sizes=16x16 href=https://zhxin.xyz/favicon-16x16.png><link rel=icon type=image/png sizes=32x32 href=https://zhxin.xyz/favicon-32x32.png><link rel=apple-touch-icon href=https://zhxin.xyz/apple-touch-icon.png><link rel=mask-icon href=https://zhxin.xyz/safari-pinned-tab.svg><meta name=theme-color content="#2e2e33"><meta name=msapplication-TileColor content="#2e2e33"><noscript><style>#theme-toggle,.top-link{display:none}</style></noscript><link rel=preconnect href=https://fonts.googleapis.com><link rel=preconnect href=https://fonts.gstatic.com crossorigin><link href="https://fonts.googleapis.com/css2?family=Noto+Sans+SC:wght@100;300&display=swap" rel=stylesheet><link href="https://fonts.googleapis.com/css2?family=Source+Code+Pro&display=swap" rel=stylesheet><script async src=//busuanzi.ibruce.info/busuanzi/2.3/busuanzi.pure.mini.js></script>
<script src=https://cdn.jsdelivr.net/npm/feather-icons/dist/feather.min.js></script><meta property="og:title" content="Git 基本操作"><meta property="og:description" content="配置 git config --list --show-origin 查看所有配置信息 git config 命令带入&ndash;system参数会将配置写入/etc/gitconfig文件，对整个系统生效；&ndash;global选项会写入~/.gitconfig文件对当前用户所有仓库生效 #安装完成GIT之后配置相关用户名邮箱 git config --global user.name &#34;me&#34; git config --global user.email me@outlook.com git config --global core.editor vim git config --global log.date iso git config --global merge.conflictstyle diff3 git config --global merge.tool nvimdiff3 配置github ssh 访问 ls -al ~/.ssh [[查看是否生成SSH]] key ssh-keygen -t rsa -b 4096 -C &#34;me@outlook.com&#34; [[生成key"><meta property="og:type" content="article"><meta property="og:url" content="https://zhxin.xyz/post/2021/03/git-%E5%9F%BA%E6%9C%AC%E6%93%8D%E4%BD%9C/"><meta property="article:section" content="post"><meta property="article:published_time" content="2021-03-28T22:49:38+08:00"><meta property="article:modified_time" content="2021-03-28T22:49:38+08:00"><meta property="og:site_name" content="zhxin"><meta name=twitter:card content="summary"><meta name=twitter:title content="Git 基本操作"><meta name=twitter:description content="配置 git config --list --show-origin 查看所有配置信息 git config 命令带入&ndash;system参数会将配置写入/etc/gitconfig文件，对整个系统生效；&ndash;global选项会写入~/.gitconfig文件对当前用户所有仓库生效 #安装完成GIT之后配置相关用户名邮箱 git config --global user.name &#34;me&#34; git config --global user.email me@outlook.com git config --global core.editor vim git config --global log.date iso git config --global merge.conflictstyle diff3 git config --global merge.tool nvimdiff3 配置github ssh 访问 ls -al ~/.ssh [[查看是否生成SSH]] key ssh-keygen -t rsa -b 4096 -C &#34;me@outlook.com&#34; [[生成key"><script type=application/ld+json>{"@context":"https://schema.org","@type":"BreadcrumbList","itemListElement":[{"@type":"ListItem","position":1,"name":"所有文章","item":"https://zhxin.xyz/post/"},{"@type":"ListItem","position":2,"name":"Git 基本操作","item":"https://zhxin.xyz/post/2021/03/git-%E5%9F%BA%E6%9C%AC%E6%93%8D%E4%BD%9C/"}]}</script><script type=application/ld+json>{"@context":"https://schema.org","@type":"BlogPosting","headline":"Git 基本操作","name":"Git 基本操作","description":"配置 git config --list --show-origin 查看所有配置信息 git config 命令带入\u0026ndash;system参数会将配置写入/etc/gitconfig文件，对整个系统生效；\u0026ndash;global选项会写入~/.gitconfig文件对当前用户所有仓库生效 #安装完成GIT之后配置相关用户名邮箱 git config --global user.name \u0026#34;me\u0026#34; git config --global user.email me@outlook.com git config --global core.editor vim git config --global log.date iso git config --global merge.conflictstyle diff3 git config --global merge.tool nvimdiff3 配置github ssh 访问 ls -al ~/.ssh [[查看是否生成SSH]] key ssh-keygen -t rsa -b 4096 -C \u0026#34;me@outlook.com\u0026#34; [[生成key","keywords":["git"],"articleBody":"配置 git config --list --show-origin 查看所有配置信息 git config 命令带入–system参数会将配置写入/etc/gitconfig文件，对整个系统生效；–global选项会写入~/.gitconfig文件对当前用户所有仓库生效\n#安装完成GIT之后配置相关用户名邮箱 git config --global user.name \"me\" git config --global user.email me@outlook.com git config --global core.editor vim git config --global log.date iso git config --global merge.conflictstyle diff3 git config --global merge.tool nvimdiff3 配置github ssh 访问\nls -al ~/.ssh [[查看是否生成SSH]] key ssh-keygen -t rsa -b 4096 -C \"me@outlook.com\" [[生成key]] eval \"$(ssh-agent -s)\" [[保证ssh可用]] ssh-add ~/.ssh/id_rsa [[添加ssh]] key到客户端 将ssh key添加到github账户 clip \u003c ~/.ssh/id_rsa.pub ssh -T git@github.com [[测试是否连接到github]] 操作 初始化 git init命令创建一个本地的仓库 git clone / clone一个已经存在的仓库 添加追踪文件 git add 添加文件到仓库暂存区 提交: 尝试每个提交成为一个逻辑上独立的变更集，并且每个提交附带一个 有用的信息 git diff --check 检查是否有空白错误 git commit 加-a参数会跳过暂存，将所有已追踪文件一起提交 删除文件 rm file #本地删除文件，修改未放入暂存区 git rm file #修改待提交，提交完成之后文件不再跟踪 git rm -f file #删除已经修改或者已经暂存的文件 git rm --cached file #将文件从仓库中删除但是保留在本地 文件重命名 git mv old new 贮藏 git stash #贮藏当前未提交内容 git stash list #查看已经贮藏的列表 git stash apply #应用最新贮藏 git stash apply #指定应用的贮藏 git stash pop #应用贮藏并从栈上丢弃 清理工作目录 git clean -f -d [-n] git stash --all 查询 仓库状态 git status查看当前仓库状态； git diff查看详细的未暂存文件与暂存区域的差异； git diff --staged/cached 查看对比已暂存文件与最后一次提交的文件差异; git diff master...contrib 查看当前contrib分支与master分支的共同祖先起，该分支中的工作。 提交记录 git log 按照时间顺序显示提交记录; git log -p 附带提交记录变化； git log --stat 显示缩略统计信息; git log --pretty=oneline\\full\\fuller\\short 自定义输出信息程度; 可以自定义log输出格式 git log --pretty=format:\"%h - %an, %ar : %s\" git log --pretty=format:\"%h %s\" --graph 选项 说明 %H 提交的完整哈希值 %h 提交的简写哈希值 %T 树的完整哈希值 %t 树的简写哈希值 %P 父提交的完整哈希值 %p 父提交的简写哈希值 %an 作者名字 %ae 作者的电子邮件地址 %ad 作者修订日期（可以用 –date=选项 来定制格式） %ar 作者修订日期，按多久以前的方式显示 %cn 提交者的名字 %ce 提交者的电子邮件地址 %cd 提交日期 %cr 提交日期（距今多长时间） %s 提交说明 git log 常用选项\n选项 说明 -p 按补丁格式显示每个提交引入的差异。 –stat 显示每次提交的文件修改统计信息。 –shortstat 只显示 –stat 中最后的行数修改添加移除统计。 –name-only 仅在提交信息后显示已修改的文件清单。 –name-status 显示新增、修改、删除的文件清单。 –abbrev-commit 仅显示 SHA-1 校验和所有 40 个字符中的前几个字符。 –relative-date 使用较短的相对时间而不是完整格式显示日期（比如“2 weeks ago”）。 –graph 在日志旁以 ASCII 图形显示分支与合并历史。 –pretty 使用其他格式显示历史提交信息。可用的选项包括 oneline、short、full、fuller 和format（用来定义自己的格式）。 –oneline –pretty=oneline –abbrev-commit 合用的简写。 限制输出 git log -n git log --since=2.weeks --after --until --before git log --author --commiter --grep --all-match git log -S function_name git log --no-merges 简短输出 git log --abbrev-commit --pretty=oneline 分支差异查询 git log experiment..master # 在master分支而不在experiment分支中的提交 git log origin/master..HEAD # 在远程分支而不在当前分支的提交 git log refA refB --not refC # 查询所有被refA或者refB包含，但是不被refC包含的提交 git log --left-right experiment...master # 不是两个分支同时包含的提交查询 查看包含某次提交的tag git tag --contains [commitid] 搜索 使用git grep从提交历史、工作目录、索引中搜索字符串或者表达式 git grep --break --heading -n --count --show-function main git 日志搜索 git log -S ZLIB_BUF_MAX --oneline #查找ZLIB_BUF_MAX变量什么时候引入的 git log -L :git_deflate_bound:zlib.c #查看某个函数的每一次变更 git blame #查看文件每一行的最后一次提交记录 回退 未提交到暂存区的回退 git checkout -- git commit --amend 将暂存区文件添加到上次提交记录中，或者只修改提交信息； git reset HEAD 取消文件暂存，从待提交中剔除； 修改历史提交信息或者合并历史提交 git rebase -i HEAD~n [[p]], pick = use commit [[r]], reword = use commit, but edit the commit message [[e]], edit = use commit, but stop for amending [[s]], squash = use commit, but meld into previous commit [[f]], fixup = like \"squash\", but discard this commit log message [[x]], exec = run command (the rest of the line) using shell [[d]], drop = remove commit 重置 git reset --soft HEAD~ # 撤销上一次提交记录，只移动head指针，index指针不变，既上一次提交变为暂存状态 git reset [--mixed] HEAD~ # 撤销上一次提交，也会取消暂存所有东西 git reset --hard HEAD~ # 完全撤销上一次提交，上一次提交的内容被销毁 # 亦可以指定文件路径 远程仓库 查看远程仓库： git remote -v 添加远程仓库: git remote add url 拉取远程仓库:git fetch 拉取后会拥有那个远程仓库的所有分支的引用； 推送远程仓库: git push 查看远程仓库信息：git remote show 远程仓库重命名：git remote rename 删除远程仓库：git remote remove 标签 列举标签：git tag -l \"v1.8*\" 轻量标签：git tag v1.0 [commit] 附注标签：git tag -a v1.1 -m \"v1.1\" [commit] 推送标签：git push origin [ [--tags--] 删除标签并推送：git tag -d ; git push origin --delete 分支 git checkout -b 创建分支并切换 git merget 合并分支，如果冲突可尝试使用git mergetool解决冲突 git branch -d hotfix 删除分支 git branch -v 查看分支 git branch --merged or --no-merged 查看merge与否的分支 git branch --no-merged master 尚未合并到master的分支 git push 将分支推送到远程仓库 git checkou --track origin/serverfix 设置当前分支追踪的远程分支 git checkout -b br origin/serverfix 检出远程分支并追踪, git checkout serverfix 如果本地没有这个分支而且远程有则会自动设置追踪 git branch -u/--set-upstream-to origin/serverfix 修改本地分支追踪上游分支 git branch -vv 显示分支的详细信息 git push origin --delete serverfix 删除远程分支 变基: 如果提交存在于你的仓库之外，而别人可能基于这些提交进行开发，那么不要执行变基, 总的原则是，只对尚未推送或分享给别人的本地修改执行变基操作清理历史， 从不对已推送至别处的提交执行变基操作，这样，你才能享受到两种方式带来的便利。 # 将experiment分支的代码以变基的方式合入master git checkout experiment git rebase master git checkout master git merge experiment # or git rebase master experiment # 变基一个与另一个分支有交集的分支，只合入该分支中的有差异部分：取出client分支,找出其与server分支分歧之后的补丁，然后把这些补丁在master分支上重放 git rebase --onto master server client 忽略文件 编辑.gitignore文件,格式规范如下: • 所有空行或者以 # 开头的行都会被 Git 忽略。 • 可以使用标准的 glob 模式匹配，它会递归地应用在整个工作区中。 • 匹配模式可以以（/）开头防止递归。 • 匹配模式可以以（/）结尾指定目录。 • 要忽略指定模式以外的文件或目录，可以在模式前加上叹号（!）取反。\nglob 模式是指 shell 所使用的简化了的正则表达式。 星号（*）匹配零个或多个任意字符；[abc] 匹配 任何一个列在方括号中的字符 （这个例子要么匹配一个 a，要么匹配一个 b，要么匹配一个 c）； 问号（?）只 匹配一个任意字符；如果在方括号中使用短划线分隔两个字符， 表示所有在这两个字符范围内的都可以匹配 （比如 [0-9] 表示匹配所有 0 到 9 的数字）。 使用两个星号（**）表示匹配任意中间目录，比如 a/**/z 可以 匹配 a/z 、 a/b/z 或 a/b/c/z 等 文件参考 gitignore\n子模块 为已经存在的项目添加子模块 git submodule add 克隆包含子模块的项目 git submodule init git submodule update #或者将两步合为一步 git submodule update --init git submodule update --init --recursive #递归抓取任何嵌套的子模块 #或者在clone时进行更新 git clone --recurse-submodules 子模块更新 # cd进子模块目录 git fetch git merge #或者不在子目录中运行 git submodule update --remote 在子模块上工作 git submodule update --remote --merge git push --recurse-submodules=check #push前检查子模块是否已经提交 一些流程 提交代码流程 #创建dev分支进行开发 git checkout -b dev #添加文件到提交列表 git add modified_file git commit -m \"msg\" git checkout 本地分支名[待提交分支] git pull git merge dev git push origin 本地分支名:refs/for/远程分支名 #提交gerrit等待代码review git push origin 分支名:refs/heads/分支名 #直接提交到远程分支 #### 或者 git fetch upstream git merge upstream/master vim somefile git add somefile git commit git push origin 新建分支 #本地开好分支,推送到远程: git checkout -b feature-branch #创建并切换到分支feature-branch #推送本地的feature-branch(冒号前面的)分支到远程origin的feature-branch(冒号后面的)分支(没有会自动创建) git push origin feature-branch:feature-branch cherry-pick使用 git cherry-pick [] ... 常用options: --quit 退出当前的chery-pick序列 --continue 继续当前的chery-pick序列 --abort 取消当前的chery-pick序列，恢复当前分支 -n, --no-commit 不自动提交 -e, --edit 编辑提交信息 ","wordCount":"3249","inLanguage":"zh","datePublished":"2021-03-28T22:49:38+08:00","dateModified":"2021-03-28T22:49:38+08:00","mainEntityOfPage":{"@type":"WebPage","@id":"https://zhxin.xyz/post/2021/03/git-%E5%9F%BA%E6%9C%AC%E6%93%8D%E4%BD%9C/"},"publisher":{"@type":"Organization","name":"zhxin.xyz","logo":{"@type":"ImageObject","url":"https://zhxin.xyz/favicon.ico"}}}</script></head><body class=dark id=top><script>localStorage.getItem("pref-theme")==="light"&&document.body.classList.remove("dark")</script><header class=header><nav class=nav><div class=logo><a href=https://zhxin.xyz/ accesskey=h title="主页 (Alt + H)">主页</a><div class=logo-switches><button id=theme-toggle accesskey=t title="(Alt + T)"><svg id="moon" xmlns="http://www.w3.org/2000/svg" width="24" height="18" viewBox="0 0 24 24" fill="none" stroke="currentcolor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M21 12.79A9 9 0 1111.21 3 7 7 0 0021 12.79z"/></svg><svg id="sun" xmlns="http://www.w3.org/2000/svg" width="24" height="18" viewBox="0 0 24 24" fill="none" stroke="currentcolor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><circle cx="12" cy="12" r="5"/><line x1="12" y1="1" x2="12" y2="3"/><line x1="12" y1="21" x2="12" y2="23"/><line x1="4.22" y1="4.22" x2="5.64" y2="5.64"/><line x1="18.36" y1="18.36" x2="19.78" y2="19.78"/><line x1="1" y1="12" x2="3" y2="12"/><line x1="21" y1="12" x2="23" y2="12"/><line x1="4.22" y1="19.78" x2="5.64" y2="18.36"/><line x1="18.36" y1="5.64" x2="19.78" y2="4.22"/></svg></button></div></div><ul id=menu><li><a href=https://zhxin.xyz/categories/ title=类别><span><span class=meta-item><i data-feather=grid></i></span>
类别</span></a></li><li><a href=https://zhxin.xyz/tags/ title=标签><span><span class=meta-item><i data-feather=pocket></i></span>
标签</span></a></li><li><a href=https://zhxin.xyz/archives/ title=归档><span><span class=meta-item><i data-feather=archive></i></span>
归档</span></a></li><li><a href=https://zhxin.xyz/search/ title=搜索><span><span class=meta-item><i data-feather=search></i></span>
搜索</span></a></li></ul></nav></header><main class=main><article class=post-single><header class=post-header><div class=breadcrumbs><a href=https://zhxin.xyz/>主页</a>&nbsp;»&nbsp;<a href=https://zhxin.xyz/post/>所有文章</a></div><h1 class=post-title>Git 基本操作</h1><div class=post-meta><span class=meta-item><i data-feather=calendar></i>
<span>2021-03-28</span></span><span class=meta-item>
<i data-feather=hash></i>
<a href=https://zhxin.xyz/tags/git/>git</a></span><span class=meta-item>
<i data-feather=file-text></i>
<span>3249 字</span></span><span class=meta-item>
<i data-feather=clock></i>
<span>7 分钟</span></span>
<script>feather.replace()</script><span class=meta-item><i data-feather=book-open></i>
<span id=busuanzi_value_page_pv></span>
<script>feather.replace()</script></span></div></header><div class=toc><details open><summary accesskey=c title="(Alt + C)"><span class=details>目录</span></summary><div class=inner><ul><li><a href=#%e9%85%8d%e7%bd%ae aria-label=配置>配置</a></li><li><a href=#%e6%93%8d%e4%bd%9c aria-label=操作>操作</a></li><li><a href=#%e6%9f%a5%e8%af%a2 aria-label=查询>查询</a><ul><li><a href=#%e4%bb%93%e5%ba%93%e7%8a%b6%e6%80%81 aria-label=仓库状态>仓库状态</a></li><li><a href=#%e6%8f%90%e4%ba%a4%e8%ae%b0%e5%bd%95 aria-label=提交记录>提交记录</a></li><li><a href=#%e6%90%9c%e7%b4%a2 aria-label=搜索>搜索</a></li></ul></li><li><a href=#%e5%9b%9e%e9%80%80 aria-label=回退>回退</a></li><li><a href=#%e8%bf%9c%e7%a8%8b%e4%bb%93%e5%ba%93 aria-label=远程仓库>远程仓库</a></li><li><a href=#%e6%a0%87%e7%ad%be aria-label=标签>标签</a></li><li><a href=#%e5%88%86%e6%94%af aria-label=分支>分支</a></li><li><a href=#%e5%bf%bd%e7%95%a5%e6%96%87%e4%bb%b6 aria-label=忽略文件>忽略文件</a></li><li><a href=#%e5%ad%90%e6%a8%a1%e5%9d%97 aria-label=子模块>子模块</a></li><li><a href=#%e4%b8%80%e4%ba%9b%e6%b5%81%e7%a8%8b aria-label=一些流程>一些流程</a></li></ul></div></details></div><div class=post-content><h1 id=配置>配置<a hidden class=anchor aria-hidden=true href=#配置>#</a></h1><p><code>git config --list --show-origin</code> 查看所有配置信息
git config 命令带入&ndash;system参数会将配置写入/etc/gitconfig文件，对整个系统生效；&ndash;global选项会写入~/.gitconfig文件对当前用户所有仓库生效</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-bash data-lang=bash><span class=line><span class=cl><span class=c1>#安装完成GIT之后配置相关用户名邮箱</span>
</span></span><span class=line><span class=cl>git config --global user.name <span class=s2>&#34;me&#34;</span>
</span></span><span class=line><span class=cl>git config --global user.email me@outlook.com
</span></span><span class=line><span class=cl>git config --global core.editor vim
</span></span><span class=line><span class=cl>git config --global log.date iso
</span></span><span class=line><span class=cl>git config --global merge.conflictstyle diff3
</span></span><span class=line><span class=cl>git config --global merge.tool nvimdiff3
</span></span></code></pre></div><p>配置github ssh 访问</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-bash data-lang=bash><span class=line><span class=cl>ls -al ~/.ssh <span class=o>[[</span>查看是否生成SSH<span class=o>]]</span> key
</span></span><span class=line><span class=cl>ssh-keygen -t rsa -b <span class=m>4096</span> -C <span class=s2>&#34;me@outlook.com&#34;</span> <span class=o>[[</span>生成key<span class=o>]]</span>
</span></span><span class=line><span class=cl><span class=nb>eval</span> <span class=s2>&#34;</span><span class=k>$(</span>ssh-agent -s<span class=k>)</span><span class=s2>&#34;</span> <span class=o>[[</span>保证ssh可用<span class=o>]]</span>
</span></span><span class=line><span class=cl>ssh-add ~/.ssh/id_rsa <span class=o>[[</span>添加ssh<span class=o>]]</span> key到客户端
</span></span><span class=line><span class=cl>将ssh key添加到github账户
</span></span><span class=line><span class=cl>clip &lt; ~/.ssh/id_rsa.pub ssh -T git@github.com <span class=o>[[</span>测试是否连接到github<span class=o>]]</span>
</span></span></code></pre></div><h1 id=操作>操作<a hidden class=anchor aria-hidden=true href=#操作>#</a></h1><ol><li>初始化
<code>git init</code>命令创建一个本地的仓库
<code>git clone &lt;git repo url>/&lt;reponame> &lt;path></code> clone一个已经存在的仓库</li><li>添加追踪文件
<code>git add &lt;file></code> 添加文件到仓库暂存区</li><li>提交: 尝试每个提交成为一个逻辑上独立的变更集，并且每个提交附带一个 有用的信息
<code>git diff --check</code> 检查是否有空白错误
<code>git commit</code> 加-a参数会跳过暂存，将所有已追踪文件一起提交</li><li>删除文件</li></ol><div class=highlight><pre tabindex=0 class=chroma><code class=language-bash data-lang=bash><span class=line><span class=cl>rm file <span class=c1>#本地删除文件，修改未放入暂存区</span>
</span></span><span class=line><span class=cl>git rm file <span class=c1>#修改待提交，提交完成之后文件不再跟踪</span>
</span></span><span class=line><span class=cl>git rm -f file <span class=c1>#删除已经修改或者已经暂存的文件</span>
</span></span><span class=line><span class=cl>git rm --cached file <span class=c1>#将文件从仓库中删除但是保留在本地</span>
</span></span></code></pre></div><ol start=5><li>文件重命名
<code>git mv old new</code></li><li>贮藏</li></ol><div class=highlight><pre tabindex=0 class=chroma><code class=language-bash data-lang=bash><span class=line><span class=cl>git stash <span class=c1>#贮藏当前未提交内容</span>
</span></span><span class=line><span class=cl>git stash list <span class=c1>#查看已经贮藏的列表</span>
</span></span><span class=line><span class=cl>git stash apply <span class=c1>#应用最新贮藏</span>
</span></span><span class=line><span class=cl>git stash apply &lt;stashid&gt; <span class=c1>#指定应用的贮藏</span>
</span></span><span class=line><span class=cl>git stash pop <span class=c1>#应用贮藏并从栈上丢弃</span>
</span></span></code></pre></div><ol start=7><li>清理工作目录
<code>git clean -f -d [-n]</code>
<code>git stash --all</code></li></ol><h1 id=查询>查询<a hidden class=anchor aria-hidden=true href=#查询>#</a></h1><h2 id=仓库状态>仓库状态<a hidden class=anchor aria-hidden=true href=#仓库状态>#</a></h2><ol><li><code>git status</code>查看当前仓库状态；</li><li><code>git diff</code>查看详细的未暂存文件与暂存区域的差异；</li><li><code>git diff --staged/cached</code> 查看对比已暂存文件与最后一次提交的文件差异;</li><li><code>git diff master...contrib</code> 查看当前contrib分支与master分支的共同祖先起，该分支中的工作。</li></ol><h2 id=提交记录>提交记录<a hidden class=anchor aria-hidden=true href=#提交记录>#</a></h2><ol><li><code>git log</code> 按照时间顺序显示提交记录;</li><li><code>git log -p </code>附带提交记录变化；</li><li><code>git log --stat</code> 显示缩略统计信息;</li><li><code>git log --pretty=oneline\full\fuller\short</code> 自定义输出信息程度;</li><li>可以自定义log输出格式</li></ol><div class=highlight><pre tabindex=0 class=chroma><code class=language-bash data-lang=bash><span class=line><span class=cl>git log --pretty<span class=o>=</span>format:<span class=s2>&#34;%h - %an, %ar : %s&#34;</span>
</span></span><span class=line><span class=cl>git log --pretty<span class=o>=</span>format:<span class=s2>&#34;%h %s&#34;</span> --graph
</span></span></code></pre></div><table><thead><tr><th>选项</th><th>说明</th></tr></thead><tbody><tr><td>%H</td><td>提交的完整哈希值</td></tr><tr><td>%h</td><td>提交的简写哈希值</td></tr><tr><td>%T</td><td>树的完整哈希值</td></tr><tr><td>%t</td><td>树的简写哈希值</td></tr><tr><td>%P</td><td>父提交的完整哈希值</td></tr><tr><td>%p</td><td>父提交的简写哈希值</td></tr><tr><td>%an</td><td>作者名字</td></tr><tr><td>%ae</td><td>作者的电子邮件地址</td></tr><tr><td>%ad</td><td>作者修订日期（可以用 &ndash;date=选项 来定制格式）</td></tr><tr><td>%ar</td><td>作者修订日期，按多久以前的方式显示</td></tr><tr><td>%cn</td><td>提交者的名字</td></tr><tr><td>%ce</td><td>提交者的电子邮件地址</td></tr><tr><td>%cd</td><td>提交日期</td></tr><tr><td>%cr</td><td>提交日期（距今多长时间）</td></tr><tr><td>%s</td><td>提交说明</td></tr></tbody></table><p>git log 常用选项</p><table><thead><tr><th>选项</th><th>说明</th></tr></thead><tbody><tr><td>-p</td><td>按补丁格式显示每个提交引入的差异。</td></tr><tr><td>&ndash;stat</td><td>显示每次提交的文件修改统计信息。</td></tr><tr><td>&ndash;shortstat</td><td>只显示 &ndash;stat 中最后的行数修改添加移除统计。</td></tr><tr><td>&ndash;name-only</td><td>仅在提交信息后显示已修改的文件清单。</td></tr><tr><td>&ndash;name-status</td><td>显示新增、修改、删除的文件清单。</td></tr><tr><td>&ndash;abbrev-commit</td><td>仅显示 SHA-1 校验和所有 40 个字符中的前几个字符。</td></tr><tr><td>&ndash;relative-date</td><td>使用较短的相对时间而不是完整格式显示日期（比如“2 weeks ago”）。</td></tr><tr><td>&ndash;graph</td><td>在日志旁以 ASCII 图形显示分支与合并历史。</td></tr><tr><td>&ndash;pretty</td><td>使用其他格式显示历史提交信息。可用的选项包括 oneline、short、full、fuller 和format（用来定义自己的格式）。</td></tr><tr><td>&ndash;oneline</td><td>&ndash;pretty=oneline &ndash;abbrev-commit 合用的简写。</td></tr></tbody></table><ol start=6><li>限制输出</li></ol><pre tabindex=0><code>git log -n
git log --since=2.weeks --after --until --before
git log --author --commiter --grep --all-match
git log -S function_name
git log --no-merges
</code></pre><ol start=7><li>简短输出 <code>git log --abbrev-commit --pretty=oneline</code></li><li>分支差异查询</li></ol><div class=highlight><pre tabindex=0 class=chroma><code class=language-bash data-lang=bash><span class=line><span class=cl>git log experiment..master <span class=c1># 在master分支而不在experiment分支中的提交</span>
</span></span><span class=line><span class=cl>git log origin/master..HEAD <span class=c1># 在远程分支而不在当前分支的提交</span>
</span></span><span class=line><span class=cl>git log refA refB --not refC <span class=c1># 查询所有被refA或者refB包含，但是不被refC包含的提交</span>
</span></span><span class=line><span class=cl>git log --left-right experiment...master  <span class=c1># 不是两个分支同时包含的提交查询</span>
</span></span></code></pre></div><ol start=9><li>查看包含某次提交的tag
<code>git tag --contains [commitid]</code></li></ol><h2 id=搜索>搜索<a hidden class=anchor aria-hidden=true href=#搜索>#</a></h2><ol><li>使用<code>git grep</code>从提交历史、工作目录、索引中搜索字符串或者表达式
<code>git grep --break --heading -n --count --show-function main</code></li><li>git 日志搜索</li></ol><div class=highlight><pre tabindex=0 class=chroma><code class=language-bash data-lang=bash><span class=line><span class=cl>git log -S ZLIB_BUF_MAX --oneline <span class=c1>#查找ZLIB_BUF_MAX变量什么时候引入的</span>
</span></span><span class=line><span class=cl>git log -L :git_deflate_bound:zlib.c <span class=c1>#查看某个函数的每一次变更</span>
</span></span><span class=line><span class=cl>git blame &lt;file&gt; <span class=c1>#查看文件每一行的最后一次提交记录</span>
</span></span></code></pre></div><h1 id=回退>回退<a hidden class=anchor aria-hidden=true href=#回退>#</a></h1><ol><li>未提交到暂存区的回退
<code>git checkout -- &lt;file></code></li><li><code>git commit --amend</code> 将暂存区文件添加到上次提交记录中，或者只修改提交信息；</li><li><code>git reset HEAD &lt;file></code> 取消文件暂存，从待提交中剔除；</li><li>修改历史提交信息或者合并历史提交</li></ol><div class=highlight><pre tabindex=0 class=chroma><code class=language-text data-lang=text><span class=line><span class=cl>git rebase -i HEAD~n
</span></span><span class=line><span class=cl>[[p]], pick = use commit
</span></span><span class=line><span class=cl>[[r]], reword = use commit, but edit the commit message
</span></span><span class=line><span class=cl>[[e]], edit = use commit, but stop for amending
</span></span><span class=line><span class=cl>[[s]], squash = use commit, but meld into previous commit
</span></span><span class=line><span class=cl>[[f]], fixup = like &#34;squash&#34;, but discard this commit log message
</span></span><span class=line><span class=cl>[[x]], exec = run command (the rest of the line) using shell
</span></span><span class=line><span class=cl>[[d]], drop = remove commit
</span></span></code></pre></div><ol start=5><li>重置</li></ol><div class=highlight><pre tabindex=0 class=chroma><code class=language-bash data-lang=bash><span class=line><span class=cl>git reset --soft HEAD~ <span class=c1># 撤销上一次提交记录，只移动head指针，index指针不变，既上一次提交变为暂存状态</span>
</span></span><span class=line><span class=cl>git reset <span class=o>[</span>--mixed<span class=o>]</span> HEAD~ <span class=c1># 撤销上一次提交，也会取消暂存所有东西</span>
</span></span><span class=line><span class=cl>git reset --hard HEAD~ <span class=c1># 完全撤销上一次提交，上一次提交的内容被销毁</span>
</span></span><span class=line><span class=cl><span class=c1># 亦可以指定文件路径</span>
</span></span></code></pre></div><h1 id=远程仓库>远程仓库<a hidden class=anchor aria-hidden=true href=#远程仓库>#</a></h1><ol><li>查看远程仓库： <code>git remote -v</code></li><li>添加远程仓库: <code>git remote add &lt;shortname> url</code></li><li>拉取远程仓库:<code>git fetch &lt;shortname></code> 拉取后会拥有那个远程仓库的所有分支的引用；</li><li>推送远程仓库: <code>git push &lt;remote> &lt;branch></code></li><li>查看远程仓库信息：<code>git remote show &lt;remote></code></li><li>远程仓库重命名：<code>git remote rename &lt;old> &lt;new></code></li><li>删除远程仓库：<code>git remote remove &lt;name></code></li></ol><h1 id=标签>标签<a hidden class=anchor aria-hidden=true href=#标签>#</a></h1><ol><li>列举标签：<code>git tag -l "v1.8*"</code></li><li>轻量标签：<code>git tag v1.0 [commit]</code></li><li>附注标签：<code>git tag -a v1.1 -m "v1.1" [commit]</code></li><li>推送标签：<code>git push origin [&lt;tagname> [--tags--]</code></li><li>删除标签并推送：<code>git tag -d &lt;tagname>; git push origin --delete &lt;tagname></code></li></ol><h1 id=分支>分支<a hidden class=anchor aria-hidden=true href=#分支>#</a></h1><ol><li><code>git checkout -b &lt;new_branch></code>创建分支并切换</li><li><code>git merget &lt;hostfix></code> 合并分支，如果冲突可尝试使用<code>git mergetool</code>解决冲突</li><li><code>git branch -d hotfix</code> 删除分支</li><li><code>git branch -v</code> 查看分支</li><li><code>git branch --merged or --no-merged</code> 查看merge与否的分支</li><li><code>git branch --no-merged master</code> 尚未合并到master的分支</li><li><code>git push &lt;remote> &lt;branch></code> 将分支推送到远程仓库</li><li><code>git checkou --track origin/serverfix</code> 设置当前分支追踪的远程分支</li><li><code>git checkout -b br origin/serverfix</code> 检出远程分支并追踪, <code>git checkout serverfix </code>如果本地没有这个分支而且远程有则会自动设置追踪</li><li><code>git branch -u/--set-upstream-to origin/serverfix</code> 修改本地分支追踪上游分支</li><li><code>git branch -vv</code> 显示分支的详细信息</li><li><code>git push origin --delete serverfix</code> 删除远程分支</li><li>变基: <strong>如果提交存在于你的仓库之外，而别人可能基于这些提交进行开发，那么不要执行变基</strong>, 总的原则是，只对尚未推送或分享给别人的本地修改执行变基操作清理历史， 从不对已推送至别处的提交执行变基操作，这样，你才能享受到两种方式带来的便利。</li></ol><div class=highlight><pre tabindex=0 class=chroma><code class=language-bash data-lang=bash><span class=line><span class=cl><span class=c1># 将experiment分支的代码以变基的方式合入master</span>
</span></span><span class=line><span class=cl>git checkout experiment
</span></span><span class=line><span class=cl>git rebase master
</span></span><span class=line><span class=cl>git checkout master
</span></span><span class=line><span class=cl>git merge experiment
</span></span><span class=line><span class=cl><span class=c1># or</span>
</span></span><span class=line><span class=cl>git rebase master experiment
</span></span><span class=line><span class=cl><span class=c1># 变基一个与另一个分支有交集的分支，只合入该分支中的有差异部分：取出client分支,找出其与server分支分歧之后的补丁，然后把这些补丁在master分支上重放</span>
</span></span><span class=line><span class=cl>git rebase --onto master server client
</span></span></code></pre></div><h1 id=忽略文件>忽略文件<a hidden class=anchor aria-hidden=true href=#忽略文件>#</a></h1><p>编辑.gitignore文件,格式规范如下:
• 所有空行或者以 # 开头的行都会被 Git 忽略。
• 可以使用标准的 glob 模式匹配，它会递归地应用在整个工作区中。
• 匹配模式可以以（/）开头防止递归。
• 匹配模式可以以（/）结尾指定目录。
• 要忽略指定模式以外的文件或目录，可以在模式前加上叹号（!）取反。</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-text data-lang=text><span class=line><span class=cl>glob 模式是指 shell 所使用的简化了的正则表达式。 星号（*）匹配零个或多个任意字符；[abc] 匹配
</span></span><span class=line><span class=cl>任何一个列在方括号中的字符 （这个例子要么匹配一个 a，要么匹配一个 b，要么匹配一个 c）； 问号（?）只
</span></span><span class=line><span class=cl>匹配一个任意字符；如果在方括号中使用短划线分隔两个字符， 表示所有在这两个字符范围内的都可以匹配
</span></span><span class=line><span class=cl>（比如 [0-9] 表示匹配所有 0 到 9 的数字）。 使用两个星号（**）表示匹配任意中间目录，比如 a/**/z 可以
</span></span><span class=line><span class=cl>匹配 a/z 、 a/b/z 或 a/b/c/z 等
</span></span></code></pre></div><p>文件参考 <a href=https://github.com/github/gitignore>gitignore</a></p><h1 id=子模块>子模块<a hidden class=anchor aria-hidden=true href=#子模块>#</a></h1><ol><li>为已经存在的项目添加子模块
<code>git submodule add &lt;url> &lt;path></code></li><li>克隆包含子模块的项目</li></ol><div class=highlight><pre tabindex=0 class=chroma><code class=language-bash data-lang=bash><span class=line><span class=cl>git submodule init
</span></span><span class=line><span class=cl>git submodule update
</span></span><span class=line><span class=cl><span class=c1>#或者将两步合为一步</span>
</span></span><span class=line><span class=cl>git submodule update --init
</span></span><span class=line><span class=cl>git submodule update --init --recursive <span class=c1>#递归抓取任何嵌套的子模块</span>
</span></span><span class=line><span class=cl><span class=c1>#或者在clone时进行更新</span>
</span></span><span class=line><span class=cl>git clone --recurse-submodules &lt;url&gt;
</span></span></code></pre></div><ol start=3><li>子模块更新</li></ol><div class=highlight><pre tabindex=0 class=chroma><code class=language-bash data-lang=bash><span class=line><span class=cl><span class=c1># cd进子模块目录</span>
</span></span><span class=line><span class=cl>git fetch
</span></span><span class=line><span class=cl>git merge
</span></span><span class=line><span class=cl><span class=c1>#或者不在子目录中运行</span>
</span></span><span class=line><span class=cl>git submodule update --remote
</span></span></code></pre></div><ol start=4><li>在子模块上工作</li></ol><div class=highlight><pre tabindex=0 class=chroma><code class=language-bash data-lang=bash><span class=line><span class=cl>git submodule update --remote --merge
</span></span><span class=line><span class=cl>git push --recurse-submodules<span class=o>=</span>check <span class=c1>#push前检查子模块是否已经提交</span>
</span></span></code></pre></div><h1 id=一些流程>一些流程<a hidden class=anchor aria-hidden=true href=#一些流程>#</a></h1><ol><li>提交代码流程</li></ol><div class=highlight><pre tabindex=0 class=chroma><code class=language-bash data-lang=bash><span class=line><span class=cl><span class=c1>#创建dev分支进行开发</span>
</span></span><span class=line><span class=cl>git checkout -b dev
</span></span><span class=line><span class=cl><span class=c1>#添加文件到提交列表</span>
</span></span><span class=line><span class=cl>git add modified_file
</span></span><span class=line><span class=cl>git commit -m <span class=s2>&#34;msg&#34;</span>
</span></span><span class=line><span class=cl>git checkout 本地分支名<span class=o>[</span>待提交分支<span class=o>]</span>
</span></span><span class=line><span class=cl>git pull
</span></span><span class=line><span class=cl>git merge dev
</span></span><span class=line><span class=cl>git push origin 本地分支名:refs/for/远程分支名 <span class=c1>#提交gerrit等待代码review</span>
</span></span><span class=line><span class=cl>git push origin 分支名:refs/heads/分支名 <span class=c1>#直接提交到远程分支</span>
</span></span><span class=line><span class=cl><span class=c1>#### 或者</span>
</span></span><span class=line><span class=cl>git fetch upstream
</span></span><span class=line><span class=cl>git merge upstream/master
</span></span><span class=line><span class=cl>vim somefile
</span></span><span class=line><span class=cl>git add somefile
</span></span><span class=line><span class=cl>git commit
</span></span><span class=line><span class=cl>git push origin &lt;branch&gt;
</span></span></code></pre></div><ol start=2><li>新建分支</li></ol><div class=highlight><pre tabindex=0 class=chroma><code class=language-bash data-lang=bash><span class=line><span class=cl><span class=c1>#本地开好分支,推送到远程:</span>
</span></span><span class=line><span class=cl>git checkout -b feature-branch <span class=c1>#创建并切换到分支feature-branch</span>
</span></span><span class=line><span class=cl><span class=c1>#推送本地的feature-branch(冒号前面的)分支到远程origin的feature-branch(冒号后面的)分支(没有会自动创建)</span>
</span></span><span class=line><span class=cl>git push origin feature-branch:feature-branch
</span></span></code></pre></div><ol start=3><li>cherry-pick使用</li></ol><div class=highlight><pre tabindex=0 class=chroma><code class=language-text data-lang=text><span class=line><span class=cl>git cherry-pick [&lt;options&gt;] &lt;commit-ish&gt;...
</span></span><span class=line><span class=cl>常用options:
</span></span><span class=line><span class=cl>--quit            退出当前的chery-pick序列
</span></span><span class=line><span class=cl>--continue        继续当前的chery-pick序列
</span></span><span class=line><span class=cl>--abort           取消当前的chery-pick序列，恢复当前分支
</span></span><span class=line><span class=cl>-n, --no-commit   不自动提交
</span></span><span class=line><span class=cl>-e, --edit        编辑提交信息
</span></span></code></pre></div></div><footer class=post-footer><ul class=post-tags><li><a href=https://zhxin.xyz/tags/git/>git</a></li></ul><nav class=paginav><a class=prev href=https://zhxin.xyz/post/2021/05/pg-peering%E8%BF%87%E7%A8%8B%E7%8A%B6%E6%80%81%E5%8F%98%E5%8C%96%E4%BB%A3%E7%A0%81%E8%B5%B0%E8%AF%BB/><span class=title>« 上一页</span><br><span>PG Peering过程状态变化代码走读</span></a>
<a class=next href=https://zhxin.xyz/post/2021/02/%E8%BD%AC%E8%BD%BDceph%E5%AD%98%E5%82%A8%E5%BC%95%E6%93%8Ebluestore%E8%A7%A3%E6%9E%90/><span class=title>下一页 »</span><br><span>【转载】ceph存储引擎bluestore解析</span></a></nav></footer><head><link rel=stylesheet href=/waline/waline.css><style>:root{--waline-font-size:16px;--waline-avatar-size:1.75rem}.wl-header input{font-size:16px;background:var(--waline-bgcolor-light)}.wl-editor{min-height:8em}.wl-actions{display:none;opacity:0;visibility:hidden}</style><script src=/waline/waline.js></script></head><body><span class=post-comments><div id=waline></div><script>const locale={nick:"昵称(必须)",mail:"邮箱(必须)",placeholder:"欢迎评论, 支持Markdown, 隐匿IP和邮箱. ",sofa:""};Waline.init({el:"#waline",serverURL:"https://hey.zhxin.xyz",dark:"body.dark",emoji:!1,requiredMeta:["nick","mail"],login:"disable",wordLimit:512,pageSize:5,imageUploader:!1,search:!1,copyright:!1,reaction:!1,lang:"zh",locale})</script></span></body></article></main><footer class=footer><span class=bs-item><span id=busuanzi_container_site_pv></span><i data-feather=eye> </i><span id=busuanzi_value_site_pv></span></span>
<span class=bs-item><span id=busuanzi_container_site_uv></span><i data-feather=user> </i><span id=busuanzi_value_site_uv></span></span><br><span><a href=https://zhxin.xyz/>zhxin.xyz</a> &copy; 2023 Powered by
<a href=https://gohugo.io/ rel="noopener noreferrer" target=_blank>Hugo</a>
<a href=https://github.com/adityatelange/hugo-PaperMod/ rel=noopener target=_blank>PaperMod</a>
<a href=https://waline.js.org/ rel=noopener target=_blank>Waline</a></span></footer><a href=#top aria-label="go to top" title="Go to Top (Alt + G)" class=top-link id=top-link accesskey=g><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 12 6" fill="currentcolor"><path d="M12 6H0l6-6z"/></svg></a><script>feather.replace();let menu=document.getElementById("menu");menu&&(menu.scrollLeft=localStorage.getItem("menu-scroll-position"),menu.onscroll=function(){localStorage.setItem("menu-scroll-position",menu.scrollLeft)}),document.querySelectorAll('a[href^="#"]').forEach(e=>{e.addEventListener("click",function(e){e.preventDefault();var t=this.getAttribute("href").substr(1);window.matchMedia("(prefers-reduced-motion: reduce)").matches?document.querySelector(`[id='${decodeURIComponent(t)}']`).scrollIntoView():document.querySelector(`[id='${decodeURIComponent(t)}']`).scrollIntoView({behavior:"smooth"}),t==="top"?history.replaceState(null,null," "):history.pushState(null,null,`#${t}`)})})</script><script>var mybutton=document.getElementById("top-link");window.onscroll=function(){document.body.scrollTop>800||document.documentElement.scrollTop>800?(mybutton.style.visibility="visible",mybutton.style.opacity="1"):(mybutton.style.visibility="hidden",mybutton.style.opacity="0")}</script><script>document.getElementById("theme-toggle").addEventListener("click",()=>{document.body.className.includes("dark")?(document.body.classList.remove("dark"),localStorage.setItem("pref-theme","light")):(document.body.classList.add("dark"),localStorage.setItem("pref-theme","dark"))})</script><script>document.querySelectorAll("pre > code").forEach(e=>{const n=e.parentNode.parentNode,t=document.createElement("button");t.classList.add("copy-code"),t.innerHTML="复制";function s(){t.innerHTML="已复制！",setTimeout(()=>{t.innerHTML="复制"},2e3)}t.addEventListener("click",t=>{if("clipboard"in navigator){navigator.clipboard.writeText(e.textContent),s();return}const n=document.createRange();n.selectNodeContents(e);const o=window.getSelection();o.removeAllRanges(),o.addRange(n);try{document.execCommand("copy"),s()}catch{}o.removeRange(n)}),n.classList.contains("highlight")?n.appendChild(t):n.parentNode.firstChild==n||(e.parentNode.parentNode.parentNode.parentNode.parentNode.nodeName=="TABLE"?e.parentNode.parentNode.parentNode.parentNode.parentNode.appendChild(t):e.parentNode.appendChild(t))})</script></body></html>